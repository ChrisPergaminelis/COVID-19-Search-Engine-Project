# NOODLE(TM) Μηχανή Αναζήτησης

Αγαμέμνων Κυριαζής      4400

Χρήστος Περγαμηνέλης    4474

![logo.png](https://www.dropbox.com/s/it9txf431ui1oj8/logo.png?dl=0&raw=1)
εικόνα 1

### 1)Εισαγωγή.
Η μηχανή αναζήτησης NOODLE(TM) σε συνδιασμό με τα βοηθητικά προγράμματα που την συνοδεύουν αποτελούν
την εξαμηνιαία εγρασία μας για το μάθημα της ανάκτησης πληροφορίας, με επιβλέπουσα καθηγήτρια την κυρία Ε. Πιτουρά.
Η NOODLE είναι γραμμένη εξ'ολοκλήρου στη γλώσσα προγραμματισμού Java και χρησιμοποιεί την Apache Lucene 8.8.1,
για να υλοποιήσει τις διαδικασίες indexing των αρχείων που αποτελούν την βάση δεδομένων της και αναζήτησης σε αυτήν. 
Προτείνεται έκδοση **Java13** ή νεότερες για την εύρυθμη λειτουργία της εφαρμογής.

### 2)Επικοινωνία εφαρμογής με τον χρήστη και πρώτη εκκίνηση.
Η NOODLE διαθέτει graphical user interface (g.u.i.), το οποίο επιτρέπει στον χρήστη να χειρίζεται την εφαρμογή μας με άνεση,
χωρίς να χρειάζεται να γνωρίζει τον κώδικα που λειτουργεί στο υπόβαθρο ή να μπορεί να διαχειριστεί το τερματικό
του υπολογιστή του. Η χρωματική παλλέτα του g.u.i. είναι τα σκούρα γκρί χρώματα όπου είναι πιο ξεκούραστα για το ανθρώπινο μάτι. Η συγκεκριμένη διεπαφή περιέχει όλα όσα χρειάζεται ο χρήστης για να πραγματοποιήσει μια αποδοτική αναζήτηση. Στη μπάρα κειμένου ο χρήστης τοποθετεί την ερώτηση του και μπορεί να την καταχωρήσει πατώντας το κουμπί *Search*.
Στη συνέχεια το σύστημα ανοίγει ένα pop up window όπου δίνει την δυνατότητα στον χρήστη να κάνει πιο στοχευμένη αναζήτηση και μετά του επιστρέφει τα αποτελέσματα ανα δέκα σε σελίδες. Επιπλέον του δύνεται η δυνατότητα ταξινόμισης των αποτελεσμάτων με το κουμπί *Sort Results*. Αρχικά, κατά την πρώτη εκκίνηση του NOODLE.jar, η εφαρμογή θα δημιουργήσει τον κατάλογο Noodle στον ίδιο κατάλογο με αυτόν που έγινε η εκκίνηση του jar. Επιπλέον η εφαρμογή δημιουργεί, εσωτερικά του καταλόγου Noodle, τα αρχεία log.txt και history.txt και τον κατάλογο dataFolder στον οποίον ο χρήστης τοποθετεί αργότερα, μετά από σχετικό pop up μήνυμα του προγράμματος.
Επειδή κατά την πρώτη εκκίνηση τα αρχεία κειμένου όπου χρειάζεται η NOODLE για την διαδικασία του indexing απουσιάζουν,
ο χρήστης καλείται να τα τοποθετήσει μόνος του στον κατάλογο dataFolder. Τα συσκεκριμένα αρχεία μπορούν να βρεθούν
στο αποθετήριο μας στο github στον συμπιεσμένο κατάλογο archives.zip. Ο χρήστης θα πρέπει να αποσυμπιέσει τον κατάλογο
archives.zip και να αντιγράψει **μονο** τα .txt αρχεία μέσα στον κατάλογο dataFolder και μετά να ξεκινήσει την εφαρμογή,
πατώντας "διπλό κλίκ" με το ποντίκη στο αρχείο NOODLE.jar. Αμέσως μετά από αυτό η εφαρμογή μας θα δημιουργήσει, εσωτερικά
του καταλόγου Noodle, τους καταλόγους indexPath και dictionary. Ο φάκελος indexFolder αποθηκεύει τα αρχεία που προκύπτουν
μετά την διαδικασία του indexing των αρχείων κειμένου από την Lucene και ο κατάλογος dictionary αποθηκεύει μια δομή λεξικού
η οποία προκύπτει από όλα τα αρχεία κειμένου της βάσης δεδομένων μας.

### 3)Λειτουργικότητα.
Η NOODLE χρησιμοποιεί την Apache Lucene για να εκτελέσει διαδικασίες όπως η αντίστροφη δεικτοδότηση των αρχείων κειμένου,
η αναζήτηση σε αυτά και η δημιουργίας λεξικού με εναλλακτικές προτάσεις αναζήτησης *did you mean ...?* στην περίπτωση όπου 
η μηχανή αναζήτησης βρει πολύ λίγα αρχεία για την αρχική ερώτηση του χρήστη.
Η αναζήτηση στη μηχανή NOODLE μπορεί να γίνει με το κουμπί *Search* που βρίσκεται στην αρχική οθόνη αφού ο χρήστης
γράψει την ερώτηση του στο πλαίσιο κειμένου που βρίσκεται ακριβώς από πάνω του. Επίσης ο χρήστης έχει την δυνατότητα να ταξινομίσει τα αποτελέσματα της αναζήτησης με τα εξής κριτήρια: "Πιο σχετικό πρώτο", "Πιο πρόσφατο πρώτο" και "Παλαιότερο πρώτο".
**Η μόνη γλώσσα που υποστιρίζει η μηχανή αναζήτησης NOODLE είναι τα αγγλικά.**
Επιπλέον η μηχανή μας διαθέτει σύστημα καταγραφής ιστορικού αναζήτησης καθώς και επισκεψημότητας σελίδας, καταγράφοντας
όχι μόνο τις αναζητήσεις αλλά και τις σελίδες που επισκέφθηκε ο χρήστης μετά από αυτήν, μαζί με την ημερομηνία
και την ώρα όπου αυτό έγινε. Ο χρήστης μπορεί να δεί το συγκεκριμένο ιστορικό πατώντας το κουμπί *History* στο γραφικό
περιβάλλον της μηχανής. Αφού "ανοίξει" το ιστορικό μπορεί με το κουμπί *Back* να επιστρέψει στην αρχική οθόνη είτε με το
κουμπί *Delete* να το διαγράψει.
Τέλος η NOODLE διαθέτει σύστημα καταγραφής ιστορικού κλήσεων συναρτήσεων logfile όπου καταγράφονται όλες οι κλήσεις 
και τα σφάλματα που ενδέχεται να προκύψουν από τις συναρτήσεις του συστήματος καθώς και η ημερομηνία και η ώρα που συνέβησαν.
Ο σκοπός αυτής της λειτουργίας είναι η παρακολούθηση της πορείας του προγράμματος καθώς και η ευκολότερη αποσφαλμάτωση του
σε περίπτωση βλάβης.

### 4)Δημιουργία βάσης δεδομένων dataFolder.
Η βάση δεδομένων dataFolder δημιουργήθηκε από το αρχείο covid19_articles_20201231.csv όπου βρίσκεται στη σελίδα
μας στο github. Ο σύνδεσμος για το kaggle από όπου και κατεβάσαμε το συγκεκριμένο αρχείο δίνεται [εδώ](https://www.kaggle.com/jannalipenkova/covid19-public-media-dataset).
Για να μετατρέψουμε το αρχείο csv σε άρθρα σε αρχεία κειμένου φτιάξαμε αρχικά το αρχείο data_extractor.py όπου εξηγήθηκε
κατά την πρώτη παράδοση της άσκησης. Αργότερα όμως επειδή θέλαμε όλο το project να είναι γραμμένο σε μια γλώσσα
προγραμματισμου υλοποιήσαμε το CsvToText.java, το οποίο εκτός από τις λειτουργίες που έχει το data_extractor.py, διαθέτει
και γραφικό περιβάλλον για την επιλογή του csv αρχείου, καθώς και του καταλόγου όπου θα δημιουργηθούν τα αρχεία κειμένου.
Αρχικά το πρόγραμμα περιμένει να λάβει είσοδο το πλήθος των γραμμών όπου θα διαβάσει από το csv. Στη συνέχεια ζητάει από τον χρήστη μέσω ενός g.u.i. να επιλέξει το αρχείο csv όπου επιθυμεί και αμέσως μετά τον κατάλογο που θέλει να δημιουργηθεί η βάση δεδομένων. Στη συνέχεια με τη χρήση των βιβλιοθηκών *opencsv-5.4* και *commons-lang3-3.12.0* το πρόγραμμα διαβάζει μια προς μια τις γραμμές του αρχείου csv και για κάθε γραμμή δημιουργεί ένα αρχείο κειμένου στο οποίο καταγράφει με διαχωριστικό κενής γραμμής τις στύλες που μας ενδιαφέρουν. Αυτές είναι ο τίτλος του άρθρου, το όνομα του αρθρογράφου ή της πηγής του άρθρου, σημειώνεται ότι αν δεν υπάρχει αυτό το πεδίο το πρόγραμμα το αντικαθιστά με "Anonymous Author" , η ημερομηνία δημοσίευσης του άρθρου και τα περιεχόμενα στο κυρίως κείμενο.
**Το format των αρχείων κειμένου και του csv αρχείου είναι συγκεκριμένο και δεν πρέπει να αλλάξει.**
Δίνεται παρακάτω το format των αρχείων κειμένου:
~~~
As virus spreads to more Chinese cities, WHO calls emergency meeting # Title
Se Young Lee, Colin Qian # Author(s)
2020-01-20 # Date
An outbreak of a new coronavirus has spread to more Chinese cities, including the capital Beijing and Shanghai, authorities said on Monday, and a fourth case has been reported beyond China’s borders. China’s National Health Commission confirmed that the virus, which causes a type of pneumonia, can pass from person-to-person, the official Xinhua News Agency said....
~~~
Συνολικά στο αρχείο dataFolder δημιουργούνται 10,000 τέτοια αρχεία κειμένου.
Για να επιλέξουμε τα συγκεκριμένα άρθρα αφού ήταν αδύνατο να τα διαβάσουμε όλα ένα προς ένα αποφασίσαμε να διαβάσουμε τα ένα καλό δείγμα από τυχαία άρθρα από το αρχείο csv. Αφού το κάναμε αυτό και θεωρούσαμε πλέον το αρχείο μια έμπιστη πηγή από την οποία μπορούμε να αντλίσουμε το ευρετήριο μας τότε προχωρήσαμε με την προσθήκη των υπόλοιπων αρχείων στην βάση δεδομένων μας.
### 5)Σε βάθος λειτουργικότητα.
Αρχικά υπάρχει η κλάση _IndexWriter η οποία αναλαμβάνει την διαδικασία της αντίστροφης δεικτοδότησης των αρχείων κειμένου.
Τα πεδία ενδιαφέροντος είναι ο τίτλος του άρθρου, ο συγκραφέας του, η ημερομηνία δημοσίευσης του και το περιεχόμενό του.
Όλα αυτά καταγράφονται από τον indexWriter καθώς και το πλήρες μονοπάτι και το όνομα του αρχείου κειμένου.
Στη συνέχεια η κλάση _IndexReader θα αναλάβει να διαβάσει το αποτέλεσμα του _IndexWriter και να παράξει ένα αντικέιμενο IndexReader. Το συγκεκριμένο αντικείμενο είναι χρήσιμο τόσο για την αναζήτηση από την κλάση _IndexSearcher όσο και από την κλάση Dictionary, αφού λεξικό διόρθωσης τυπογραφικών λαθών κατά την αναζήτηση αποτελούν τα ίδια τα αρχεία κειμένου μετά την διαδικασία της αντίστροφης δεικτοδότησης. Έτσι επιτυγχάνουμε διορθώσεις τυπογραφικών λαθών οι οποίες σίγουρα αφού εφαρμοστούν θα αντιστοιχούν σε όρους που περιέχονται στα αρχεία της βάσης μας. Η σειρά προτίμισης μιας πρότασης για διόρθωση καθορίζεται αρχικά από το term frequency στη συνέχεια από το score της όπου είναι η απόσταση Levenshtein και συμπληρωματικά από την τιμή που έχει ως αλφαριθμητικό.
Η λειτουργικότητα του _IndexSearcher περιλαμβάνει την εξυπηρέτηση ερωτημάτων από τον χρήστη με διαφορετικές ρυθμίσεις. Αρχικά ο χρήστης δίνει την φράση με την οποία θα πραγματοποιηθεί η αναζήτηση, π.χ. New virus. Στην συνέχεια η μηχανή θα ανοίξει ενα παράθυρο διαλόγου και θα ζητήσει από τον χρήστη να επιλέξει βάσει ποιού πεδίου αρχείου επιθυμεί να γίνει η αναζήτηση. Οι δυνατές επιλογές είναι "Περιεχόμενα κειμένου", "Τίτλος" και "Αρθρογράφος". Αφού πραγματοποιείσει αναζήτηση με κάποιες απο αυτές τις ρυθμίσεις αργότερα μπορεί να επιλέξει να ταξινομίσει τα αποτελέσματα, όπως εξηγήσαμε στο κεφάλαιο *Λειτουργικότητα*. Το αποτέλεσμα της αναζήτησης είναι το μέγιστο πενήντα αρχεία κειμένου σε μορφή λίστας τα οποία παρουσιάζονται ανα δεκάδες. Ο χρήστης μπορεί να δει τις υπόλοιπες σελίδες οι οποίες "κρατάνε" τις επόμενες δεκάδες αποτελεσμάτων με τα κουμπιά **Next Page** και **Previous Page**. Η λίστα που δίνεται μετά από την αναζήτηση περιλαμβάνει σε μορφή κουτιών τον τίτλο του άρθρου και μια σύντομη περιγραφή του με υπογραμισμένες με **Bold** γράμματα τις λέξεις που παρουσιάζουν ομοιότητα με την φράση που πραγματοποιήθηκε αναζήτηση.
Το στιγμιότυπο (εικόνα 2) που ακολουθεί αποτελεί το αποτέλεσμα της αναζήτησης στη μηχανή NOODLE με ερώτηση Donald Trump και πεδίο ενδιαφέροντος τα περιεχόμενα του κειμένου.

![demo1.png](https://www.dropbox.com/s/8hozkfam97zeyun/demo1.png?dl=0&raw=1)
εικόνα 2

Στην λειτουργικότητα της μηχανής NOODLE προστίθεται και η διόρθωση τυπογραφικών λαθών κατά την αναζήτηση. Αν τα άρθρα που επιστραφούν από την μηχανή κατά την αναζήτηση είναι λιγότερα από πέντε, η μηχανή είναι προγραμματισμένη να ρωτήσει τον χρήστη αν όντως αυτό που έψαχνε είναι σωστό και δεν εννοούσε κάτι άλλο το οποίο και του προτείνει. Χαρακτηριστικό παράδειγμα δίνεται από κάτω στην (εικόνα 3)

![demo2.png](https://www.dropbox.com/s/0dbcyocniyb8uqj/demo2.png?dl=0&raw=1)
εικόνα 3

Η αποδοτικότητα του λεξικού μας βασίζεται στο γεγονός ότι δημιουργείται από τα ίδια τα αρχεία που αποτελούν το ευρετήριο μας. Δηλαδή οι τίτλοι, οι συγγραφείς και το κυρίως κείμενο των αρχείων αναλύονται και συνθέτουν την δομή του λεξικού μας. Επιπρόσθετα το λεξικό βασίζεται περισσότερο στην συχνότητα εμφάνισης μίας λέξης στο κυρίως κείμενο και κατά δεύτερον στην απόσταση Levenshtein. Έτσι ναι μεν μπορεί να προτείνει πιο μεγάλες αλλαγές στις λέξεις αλλά σίγουρα οι προτάσεις θα επιστρέφουν ένα ικανοποιητικό πλήθος αρχείων κατά την αναζήτηση.
Τέλος πρέπει να σημειωθεί ότι η μηχανή NOODLE υποστιρίζει αναζήτηση με wildcard χαρακτήρα *, συμπληρώνοντας μόνη της προτάσεις και λέξεις.

![demo3.png](https://www.dropbox.com/s/rz050jy7tgz6t2e/demo3.png?dl=0&raw=1)
εικόνα 4

### 6)Ασφάλεια, επαναφορά της NOODLE και δημιουργία νεου ευρετηρίου.
Η επαναφορά της NOODLE στις αρχικές ρυθμίσεις είναι αρκετά απλή. Αρκεί να διαγράψει κάποιος ολόκληρο τον κατάλογο Noodle και όλα τα δεδομένα που κρατάει η μηχανή χάνονται. Η NOODLE **δεν** κρατάει αντίγραφα πουθενά στον υπολογιστή σας, **δεν** θα ζητήσει ποτέ άδειες επιπέδου χρήστη για την λειτουργία της και **δεν** αξιοποιεί δεδομένα από το ιστορικό αναζήτησης σας.
Μπορείτε να προσθέσετε όσα αρχεία επιθυμείται στον κατάλογο dataFolder, όμως για κάθε φορά όπου προσθέτετε ή διαγράφετε κάποιο αρχείο από αυτόν τον κατάλογο θα χρειαστεί να διαγράψετε τον κατάλογο indexFolder για να μπορέσει η NOODLE να δημιουργήσει εκ νέου το ανανεωμένο ευρετήριο.

### Demo της εργασίας.
[click me](https://youtu.be/vta4UDGwPII)
